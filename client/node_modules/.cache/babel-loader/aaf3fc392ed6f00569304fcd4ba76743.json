{"ast":null,"code":"import _regeneratorRuntime from \"C:/Users/enliv/Desktop/appstack-react-2-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"C:/Users/enliv/Desktop/appstack-react-2-master/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport faker from \"faker\";\nimport mock from \"./adapter\";\nimport { verify, sign } from \"../utils/jwt\";\nvar JWT_SECRET = \"super-secret-key\";\nvar JWT_EXPIRES_IN = \"3 days\";\nvar users = [{\n  id: \"a8553063-7bd5-45ed-adbe-db6f069a3802\",\n  displayName: \"Lucy Lavender\",\n  email: \"demo@bootlab.io\",\n  password: \"unsafepassword\",\n  avatar: \"/static/img/avatars/avatar-1.jpg\"\n}];\n\nfunction fakeRequest(time) {\n  return new Promise(function (res) {\n    return setTimeout(res, time);\n  });\n}\n\nmock.onPost(\"/api/auth/sign-in\").reply( /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(config) {\n    var _JSON$parse, email, password, user, accessToken;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.prev = 0;\n            _context.next = 3;\n            return fakeRequest(1000);\n\n          case 3:\n            _JSON$parse = JSON.parse(config.data), email = _JSON$parse.email, password = _JSON$parse.password;\n            user = users.find(function (_user) {\n              return _user.email === email;\n            });\n\n            if (user) {\n              _context.next = 7;\n              break;\n            }\n\n            return _context.abrupt(\"return\", [400, {\n              message: \"There is no user corresponding to the email address.\"\n            }]);\n\n          case 7:\n            if (!(user.password !== password)) {\n              _context.next = 9;\n              break;\n            }\n\n            return _context.abrupt(\"return\", [400, {\n              message: \"Incorrect password\"\n            }]);\n\n          case 9:\n            accessToken = sign({\n              userId: user.id\n            }, JWT_SECRET, {\n              expiresIn: JWT_EXPIRES_IN\n            });\n            return _context.abrupt(\"return\", [200, {\n              accessToken: accessToken,\n              user: user\n            }]);\n\n          case 13:\n            _context.prev = 13;\n            _context.t0 = _context[\"catch\"](0);\n            console.error(_context.t0);\n            return _context.abrupt(\"return\", [500, {\n              message: \"Internal server error\"\n            }]);\n\n          case 17:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[0, 13]]);\n  }));\n\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}());\nmock.onPost(\"/api/auth/sign-up\").reply( /*#__PURE__*/function () {\n  var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(config) {\n    var _JSON$parse2, email, password, firstName, lastName, user, accessToken;\n\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            _context2.prev = 0;\n            _context2.next = 3;\n            return fakeRequest(1000);\n\n          case 3:\n            _JSON$parse2 = JSON.parse(config.data), email = _JSON$parse2.email, password = _JSON$parse2.password, firstName = _JSON$parse2.firstName, lastName = _JSON$parse2.lastName;\n            user = users.find(function (_user) {\n              return _user.email === email;\n            });\n\n            if (!user) {\n              _context2.next = 7;\n              break;\n            }\n\n            return _context2.abrupt(\"return\", [400, {\n              message: \"There already exists an account with the given email address.\"\n            }]);\n\n          case 7:\n            user = {\n              id: faker.datatype.uuid(),\n              displayName: \"\".concat(firstName, \" \").concat(lastName),\n              email: email,\n              password: password,\n              avatar: null\n            };\n            accessToken = sign({\n              userId: user.id\n            }, JWT_SECRET, {\n              expiresIn: JWT_EXPIRES_IN\n            });\n            return _context2.abrupt(\"return\", [200, {\n              accessToken: accessToken,\n              user: user\n            }]);\n\n          case 12:\n            _context2.prev = 12;\n            _context2.t0 = _context2[\"catch\"](0);\n            console.error(_context2.t0);\n            return _context2.abrupt(\"return\", [500, {\n              message: \"Internal server error\"\n            }]);\n\n          case 16:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[0, 12]]);\n  }));\n\n  return function (_x2) {\n    return _ref2.apply(this, arguments);\n  };\n}());\nmock.onGet(\"/api/auth/my-account\").reply(function (config) {\n  try {\n    var Authorization = config.headers.Authorization;\n\n    if (!Authorization) {\n      return [401, {\n        message: \"Authorization token missing\"\n      }];\n    }\n\n    var accessToken = Authorization.split(\" \")[1];\n    var data = verify(accessToken, JWT_SECRET);\n    var userId = typeof data === \"object\" ? data === null || data === void 0 ? void 0 : data.userId : \"\";\n    var user = users.find(function (_user) {\n      return _user.id === userId;\n    });\n\n    if (!user) {\n      return [401, {\n        message: \"Invalid authorization token\"\n      }];\n    }\n\n    return [200, {\n      user: user\n    }];\n  } catch (error) {\n    console.error(error);\n    return [500, {\n      message: \"Internal server error\"\n    }];\n  }\n});","map":{"version":3,"sources":["C:/Users/enliv/Desktop/appstack-react-2-master/src/mocks/auth.ts"],"names":["faker","mock","verify","sign","JWT_SECRET","JWT_EXPIRES_IN","users","id","displayName","email","password","avatar","fakeRequest","time","Promise","res","setTimeout","onPost","reply","config","JSON","parse","data","user","find","_user","message","accessToken","userId","expiresIn","console","error","firstName","lastName","datatype","uuid","onGet","Authorization","headers","split"],"mappings":"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","sourcesContent":["import faker from \"faker\";\r\n\r\nimport mock from \"./adapter\";\r\n\r\nimport { verify, sign } from \"../utils/jwt\";\r\n\r\nconst JWT_SECRET = \"super-secret-key\";\r\nconst JWT_EXPIRES_IN = \"3 days\";\r\n\r\nconst users = [\r\n\t{\r\n\t\tid: \"a8553063-7bd5-45ed-adbe-db6f069a3802\",\r\n\t\tdisplayName: \"Lucy Lavender\",\r\n\t\temail: \"demo@bootlab.io\",\r\n\t\tpassword: \"unsafepassword\",\r\n\t\tavatar: \"/static/img/avatars/avatar-1.jpg\",\r\n\t},\r\n];\r\n\r\nfunction fakeRequest(time) {\r\n\treturn new Promise((res) => setTimeout(res, time));\r\n}\r\n\r\nmock.onPost(\"/api/auth/sign-in\").reply(async (config) => {\r\n\ttry {\r\n\t\tawait fakeRequest(1000);\r\n\r\n\t\tconst { email, password } = JSON.parse(config.data);\r\n\t\tconst user = users.find((_user) => _user.email === email);\r\n\r\n\t\tif (!user) {\r\n\t\t\treturn [\r\n\t\t\t\t400,\r\n\t\t\t\t{ message: \"There is no user corresponding to the email address.\" },\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\tif (user.password !== password) {\r\n\t\t\treturn [400, { message: \"Incorrect password\" }];\r\n\t\t}\r\n\r\n\t\tconst accessToken = sign({ userId: user.id }, JWT_SECRET, {\r\n\t\t\texpiresIn: JWT_EXPIRES_IN,\r\n\t\t});\r\n\r\n\t\treturn [200, { accessToken, user }];\r\n\t} catch (error) {\r\n\t\tconsole.error(error);\r\n\t\treturn [500, { message: \"Internal server error\" }];\r\n\t}\r\n});\r\n\r\nmock.onPost(\"/api/auth/sign-up\").reply(async (config) => {\r\n\ttry {\r\n\t\tawait fakeRequest(1000);\r\n\r\n\t\tconst { email, password, firstName, lastName } = JSON.parse(config.data);\r\n\t\tlet user = users.find((_user) => _user.email === email);\r\n\r\n\t\tif (user) {\r\n\t\t\treturn [\r\n\t\t\t\t400,\r\n\t\t\t\t{\r\n\t\t\t\t\tmessage:\r\n\t\t\t\t\t\t\"There already exists an account with the given email address.\",\r\n\t\t\t\t},\r\n\t\t\t];\r\n\t\t}\r\n\r\n\t\tuser = {\r\n\t\t\tid: faker.datatype.uuid(),\r\n\t\t\tdisplayName: `${firstName} ${lastName}`,\r\n\t\t\temail,\r\n\t\t\tpassword,\r\n\t\t\tavatar: null,\r\n\t\t};\r\n\r\n\t\tconst accessToken = sign({ userId: user.id }, JWT_SECRET, {\r\n\t\t\texpiresIn: JWT_EXPIRES_IN,\r\n\t\t});\r\n\r\n\t\treturn [200, { accessToken, user }];\r\n\t} catch (error) {\r\n\t\tconsole.error(error);\r\n\t\treturn [500, { message: \"Internal server error\" }];\r\n\t}\r\n});\r\n\r\nmock.onGet(\"/api/auth/my-account\").reply((config) => {\r\n\ttry {\r\n\t\tconst { Authorization } = config.headers;\r\n\r\n\t\tif (!Authorization) {\r\n\t\t\treturn [401, { message: \"Authorization token missing\" }];\r\n\t\t}\r\n\r\n\t\tconst accessToken = Authorization.split(\" \")[1];\r\n\t\tconst data = verify(accessToken, JWT_SECRET);\r\n\t\tconst userId = typeof data === \"object\" ? data?.userId : \"\";\r\n\t\tconst user = users.find((_user) => _user.id === userId);\r\n\r\n\t\tif (!user) {\r\n\t\t\treturn [401, { message: \"Invalid authorization token\" }];\r\n\t\t}\r\n\r\n\t\treturn [200, { user }];\r\n\t} catch (error) {\r\n\t\tconsole.error(error);\r\n\t\treturn [500, { message: \"Internal server error\" }];\r\n\t}\r\n});\r\n"]},"metadata":{},"sourceType":"module"}